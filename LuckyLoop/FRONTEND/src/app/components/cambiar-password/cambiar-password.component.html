<!-- cambiar-password.component.html -->
<div class="auth-container">
    <h2>Cambiar Contraseña</h2>
    
    <!-- Sección de carga -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Verificando...</p>
    </div>
    
    <!-- Mensaje de error -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>
    
    <!-- Mensaje de éxito -->
    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
      <p class="redirect-message">Serás redirigido a la página de inicio de sesión.</p>
    </div>
    
    <!-- Formulario de cambio de contraseña -->
    <form *ngIf="tokenValido && !successMessage" (submit)="cambiarPassword(); $event.preventDefault()">
      <p class="form-info">Introduce tu email y tu nueva contraseña.</p>
      
      <!-- Campo de email -->
      <input 
        type="email" 
        [(ngModel)]="email" 
        name="email" 
        placeholder="Correo electrónico" 
        required />
      
      <div class="password-container">
        <input 
          [type]="showPassword ? 'text' : 'password'" 
          [(ngModel)]="password" 
          name="password" 
          placeholder="Nueva contraseña" 
          required />
        <button type="button" class="toggle-password" (click)="togglePasswordVisibility()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
            <path *ngIf="showPassword" d="M3 3l18 18" stroke-width="2"></path>
          </svg>
        </button>
      </div>
      
      <div class="password-container">
        <input 
          [type]="showConfirmPassword ? 'text' : 'password'" 
          [(ngModel)]="confirmPassword" 
          name="confirmPassword" 
          placeholder="Confirmar nueva contraseña" 
          required />
        <button type="button" class="toggle-password" (click)="toggleConfirmPasswordVisibility()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
            <path *ngIf="showConfirmPassword" d="M3 3l18 18" stroke-width="2"></path>
          </svg>
        </button>
      </div>
      
      <button type="submit">Cambiar Contraseña</button>
    </form>
    
    <!-- Enlaces de navegación -->
    <div class="auth-links" *ngIf="!isLoading && (errorMessage || successMessage)">
      <p><a routerLink="/login">Volver a inicio de sesión</a></p>
    </div>
  </div>